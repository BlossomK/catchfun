<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="adminMapper2">

	<resultMap id="adminMemberResultSet" type="Member1">
		<id column="USER_NO" property="userNo"/>
		<result column="USER_ID" property="userId"/>
		<result column="USER_PWD" property="userPwd"/>
		<result column="USER_TYPE" property="userType"/>
		<result column="USER_NAME" property="userName"/>
		<result column="EMAIL" property="email"/>
		<result column="PHONE" property="phone"/>
		<result column="USER_ENROLLDATE" property="userEnrolldate"/>
		<result column="ADDRESS" property="address"/>
		<result column="ADDRESSNUM" property="addressNum"/>
		<result column="USER_POINT" property="userPoint"/>
		<result column="STATUS" property="status"/>
		<result column="REASON" property="reason"/>
	</resultMap>
	
	<resultMap id="adminReportResultSet" type="Reply1">
		<result column="P_QUESTION_NO" property="replyNo"/>
		<result column="QUESTION_CONTENT" property="questionContent"/>
		<result column="QUESTION_DATE" property="questionDate"/>
		<result column="QUESTION_YN" property="questionYN"/>
		<result column="QUESTION_STATUS" property="questionStatus"/>
		<result column="QUESTION_BAN_COUNT" property="questionBanCount"/>
		<result column="USER_ID" property="userId"/>
		<result column="USER_TYPE" property="userType"/>
		<result column="USER_NAME" property="userName"/>
		<result column="EMAIL" property="email"/>
		<result column="PHONE" property="phone"/>
		<result column="USER_ENROLLDATE" property="userEnrolldate"/>
		<result column="REPORT_CONTENT" property="reportContent"/>
		<result column="RNO" property="userNo"/>
		<result column="PNO" property="userNo1"/>
	</resultMap>
	
	<resultMap id="adminProReportResultSet" type="Project1">
		<id column="PROJECT_NUMBER" property="projectNumber"/>
		<result column="PROJECT_NAME" property="projectName"/>
		<result column="PROJECT_STARTDATE" property="projectStartDate"/>
		<result column="USER_NAME" property="userName"/>
		<result column="PHONE" property="phone"/>
		<result column="EMAIL" property="email"/>
		<result column="PROJECT_REPORT" property="projectReport"/>
		<result column="PROJECT_CONTENT" property="projectContent"/>
		<result column="PROJECT_STATUS" property="projectStatus"/>
		<result column="REPORT_NO" property="reportNo"/>
		<result column="REPORT_CATEGORY" property="reportCategory"/>
		<result column="REPORT_DATE" property="reportDate"/>
		<result column="REPORT_TITLE" property="reportTitle"/>
		<result column="REPORT_CONTENT" property="reportContent"/>
		<result column="PNO" property="userNo"/>
		<result column="RNO" property="userNo1"/>
		<result column="PROJECT_STARTDATE" property="projectStartDate"/>
		<result column="PROJECT_FINISHDATE" property="projectFinishDate"/>
		<result column="PROJECT_CATEGORY" property="projectCategory"/>
		<result column="PROJECT_TARGET_AMOUNT" property="projectTargetAmount"/>
		<result column="USER_ID" property="userId"/>
	</resultMap>
	
	<select id="memberListCount" resultType="_int">
		select count(*)
		  from member	
		 where status='Y'
		 
	</select>
	
	<select id="memberList" resultMap="adminMemberResultSet">
		select *
		  from member
		 where status='Y'
		 order by user_no asc
	</select>
	
	<select id="blackListCount" resultType="_int">
		select count(*)
		  from member
		 where status='B'  
	</select>
	
	<select id="blackList" resultMap="adminMemberResultSet">
		select *
		  from member
		 where status='B'
		 order by user_no asc 
	</select>
	
	<select id="memberSearchCount" resultType="_int">
		select count(*) 
		  from member 
		 where status='Y' and USER_ID LIKE '%' || #{keyword} || '%'
	</select>
	
	<select id="memberSearch" resultMap="adminMemberResultSet">
		select *
		  from member
		 where status='Y' and USER_ID LIKE '%' || #{keyword} || '%' 
	     order by user_no asc  
	</select>
	
	<select id="blackSearchCount" resultType="_int">
		select count(*)
		  from member
		 where status='B'and USER_ID LIKE '%' || #{keyword} || '%' 
	</select>
	
	<select id="blackSearch" resultMap="adminMemberResultSet">
		select *
		  from member
		 where status='B' and USER_ID LIKE '%' || #{keyword} || '%' 
	     order by user_no asc  
    </select> 
    
    <update id="memberSelect" parameterType="Member">
    	update Member set status=#{status} where user_no=#{userNo}
    </update>
    
    <update id="blackUpdate" parameterType="Member">
    	update Member set status='Y' where user_no=#{userNo}
    </update>
    
    <select id="reportListCount" resultType="_int">
    	select count(*)
    	  from reply r
    	  join member m on (r.user_no = m.user_no)
          join report p on (r.P_QUESTION_NO = p.REPORT_NO)
    	  where m.status='Y' and p.report_category='1' and question_status='N' 
    </select>
    
    <select id="reportList" resultMap="adminReportResultSet">
    	select *
    	  from reply r
    	  join member m on (r.user_no = m.user_no)
          join report p on (r.P_QUESTION_NO = p.REPORT_NO)
    	  where m.status='Y' and p.report_category='1'     	  
    </select>
    
    <select id="reportSearchCount" resultType="_int">
    	select count(*)
    	  from reply r
    	  join member m on (r.user_no = m.user_no)
          join report p on (r.P_QUESTION_NO = p.REPORT_NO)
    	  where m.status='Y' and p.report_category='1'and USER_ID LIKE '%' || #{keyword} || '%' 
    </select>
    
    <select id="reportSearch" resultMap="adminReportResultSet">
    	select *
    	  from reply r
    	  join member m on (r.user_no = m.user_no)
          join report p on (r.P_QUESTION_NO = p.REPORT_NO)
    	  where m.status='Y' and p.report_category='1'and m.USER_ID LIKE '%' || #{keyword} || '%'   	  
    </select>
    
    <select id="proReportListCount" resultType="_int">
    	select count(*)
		from project p
   	    join member m on(m.user_no = p.user_no)
	    join report r on(p.project_number = r.REPORT_NO)
	   where report_category=2 and PROJECT_STATUS='Y' 		 
    </select>
    
    <select id="proReportList" resultMap="adminProReportResultSet">
		select *
		from project p
   	    join member m on(m.user_no = p.user_no)
	    join report r on(p.project_number = r.REPORT_NO)
		where report_category=2 and PROJECT_STATUS='Y' 	  
    </select>
    
    <select id="proReportSearchCount" resultType="_int">
    	select count(*)
		from project p
   	    join member m on(m.user_no = p.user_no)
	    join report r on(p.project_number = r.REPORT_NO)
    	 where p.PROJECT_NUMBER LIKE '%' || #{keyword} || '%' and report_category=2 and PROJECT_STATUS='Y' 	
    </select>
    
    <select id="proReportSearch" resultMap="adminProReportResultSet">
     	select *
		from project p
   	    join member m on(m.user_no = p.user_no)
	    join report r on(p.project_number = r.REPORT_NO)
    	where p.PROJECT_NUMBER LIKE '%' || #{keyword} || '%' and report_category=2 and PROJECT_STATUS='Y' 	  	  
    </select>
    
    <select id="rpReportDetail" parameterType="string" resultMap="adminReportResultSet">
        select P_QUESTION_NO, QUESTION_CONTENT, QUESTION_DATE, QUESTION_YN, QUESTION_STATUS, QUESTION_BAN_COUNT, USER_ID, REPORT_CONTENT,
               USER_TYPE, USER_NAME, EMAIL, PHONE, USER_ENROLLDATE, r.user_no as RNO, p.user_no as PNO
    	  from reply r
    	  join member m on (r.user_no = m.user_no)
          join report p on (r.P_QUESTION_NO = p.REPORT_NO)
    	  where m.status='Y' and p.report_category='1'and P_QUESTION_NO =#{rd}   
    </select>
    
    
    <update id="reportBlack" parameterType="string">
    	update Member set status='B' where user_no=#{userNo}
    </update>
    
    <select id="pjReportDetail" parameterType="string" resultMap="adminProReportResultSet">
    	select PROJECT_NUMBER,PROJECT_NAME,PROJECT_STARTDATE,USER_NAME,PHONE,EMAIL,PROJECT_REPORT,REPORT_NO,REPORT_CATEGORY,REPORT_DATE,REPORT_TITLE,
    	       REPORT_CONTENT, PROJECT_CONTENT, p.user_no as PNO, r.user_no as RNO
		  from project p
		  join member m on(m.user_no = p.user_no)
		  join report r on(p.project_number = r.REPORT_NO)
		 where report_category=2 and PROJECT_NUMBER=#{rd} and PROJECT_STATUS='Y'
    </select>
    
    <update id="pjDelete" parameterType="string">
    	update project set PROJECT_STATUS ='N' where PROJECT_NUMBER=#{projectNumber} 
    </update>
    
    <select id="projectListCount" resultType="_int">
    	select count(*)
    	  from project p
    	  join member m on(p.user_no = m.user_no)
    	 where p.project_status='Y' 
    </select>
    
    <select id="projectList" resultMap="adminProReportResultSet">
    	select *
    	  from project p
    	  join member m on(p.user_no = m.user_no)
    	 where p.project_status='Y' 
    </select>
    


  <!-- 
  <resultMap id="adminResultSet" type="Board">
		<id column="board_no" property="boardNo"/>
		<result column="board_title" property="boardTitle"/>
		<result column="board_writer" property="boardWriter"/>
		<result column="board_content" property="boardContent"/>
		<result column="origin_name" property="originName"/>
		<result column="change_name" property="changeName"/>
		<result column="count" property="count"/>
		<result column="create_date" property="createDate"/>
		<result column="status" property="status"/>
	</resultMap>
	
	<update id="updateMember" parameterType="Member">
	  		update member
	  		   set email=#{email}, 
	  		       age=#{age},
	  		       phone=#{phone},
	  		       address=#{address},
	  		       gender=#{gender},
	  		       modify_date=sysdate
	  		 where user_id=#{userId}    
	  </update>
	  
	  <update id="deleteMember" parameterType="string">
	  		update member
	  		   set status='N' 
	  		 where user_id=#{userId}
	  </update>
	  
	  <select id="idCheck" parameterType="string" resultType="_int">
	  		select count(*)
	  		  from member
	  		 where user_id=#{userId}
	  </select>
	   -->
	   
	   <!-- 위에 참고용 -->
	   
  	<!-- 주혁시작 -->
	   
<!-- 	<resultMap id="adminNoticeResultSet" type="Notice">
		<id column="NOTICE_NO" property="noticeNo"/>
		<result column="USER_ID" property="userId"/>
		<result column="NOTICE_TITLE" property="noticeTitle"/>
		<result column="NOTICE_CONTENT" property="noticeContent"/>
		<result column="NOTICE_DATE" property="noticeDate"/>
		<result column="NOTICE_COUNT" property="noticeCount"/>
		<result column="NOTICE_STATUS" property="noticeStatus"/>
	</resultMap>
	
	<resultMap id="adminFaqResultSet" type="Faq">
		<id column="FAQ_NO" property="faqNo"/>
		<result column="USER_NO" property="userNo"/>
		<result column="FAQ_TITLE" property="faqTitle"/>
		<result column="FAQ_ANSWER" property="faqAnswer"/>
		<result column="FAQ_STATUS" property="faqStatus"/>
		<result column="FAQ_DATE" property="faqDate"/>
	</resultMap>
	
	<select id="selectListCount" resultType="_int">
		select count(*)
		  from NOTICE_TEMP
		 where NOTICE_STATUS='N'
	</select>
	
	<select id="selectList" resultMap="adminNoticeResultSet">
		select NOTICE_NO, user_Id, NOTICE_TITLE, NOTICE_CONTENT, NOTICE_DATE, NOTICE_COUNT, NOTICE_STATUS
		  from NOTICE_TEMP
		  join member m using (user_no)
		 where NOTICE_STATUS='N'
		 order by NOTICE_DATE desc
	</select>
  	
  	<select id="noticeDetail" parameterType="string" resultMap="adminNoticeResultSet">
		select *
		  from NOTICE_TEMP
		 where NOTICE_NO=#{nno}
	</select>
	
	<insert id="insertNotice" parameterType="Notice">
		insert into NOTICE_TEMP
		values('N'||seq_nno.nextval, #{userNo}, #{noticeTitle}, #{noticeContent}, default, 0, default)
	</insert>
	
	<update id="noticeDelete" parameterType="string">
		update NOTICE_TEMP
		   set NOTICE_STATUS='Y'
		 where NOTICE_NO=#{nno}
	</update>
	
	<update id="noticeUpdatInsert" parameterType="Notice">
		update NOTICE_TEMP
		   set NOTICE_TITLE=#{noticeTitle}, NOTICE_CONTENT=#{noticeContent}
		 where NOTICE_NO=#{noticeNo}
	</update>
  	주혁끝 -->
  	
  	
  
</mapper>
